{
  "description": "Phase 1 Emergency Fixes for BiLSTM Dual-Task Model (44% → 60-65% target)",
  "reference": "Based on research paper recommendations for catastrophic performance recovery",
  "model": {
    "architecture": "enhanced_simple_lstm",
    "input_dim": 11,
    "hidden_size": 128,
    "num_layers": 1,
    "num_heads": 2,
    "dropout": 0.5,
    "recurrent_dropout": 0.6,
    "use_uncertainty_weighting": false,
    "predict_pointers": true
  },

  "training": {
    "batch_size": 29,
    "learning_rate": 0.0003,
    "n_epochs": 300,
    "early_stopping_patience": 20,
    "max_grad_norm": 1.5,

    "optimizer": {
      "type": "Adam",
      "comment": "Layer-specific weight decay for differential regularization",
      "weight_decay": {
        "encoder": 0.001,
        "attention": 0.0001,
        "heads": 0.01
      }
    },

    "validation": {
      "val_split": 0.15,
      "use_temporal_split": true
    }
  },

  "loss": {
    "pointer_loss": "huber",
    "huber_delta": 0.08,
    "focal_gamma": 2.0,
    "class_weights": [1.0, 1.17],
    "manual_weights": {
      "loss_alpha": 1.0,
      "loss_beta": 0.7
    },
    "uncertainty_weighting": {
      "enabled": false,
      "comment": "Set model.use_uncertainty_weighting=true to enable learnable task weights"
    }
  },

  "data": {
    "dataset_size": 174,
    "train_samples": 148,
    "val_samples": 26,
    "features": "11D RelativeTransform",
    "sequence_length": 105
  },

  "expected_improvements": {
    "current_performance": {
      "val_accuracy": 0.44,
      "train_accuracy": 0.59,
      "overfitting_gap": 15
    },
    "target_performance": {
      "val_accuracy_range": [0.60, 0.65],
      "train_val_gap": 8,
      "hit_at_pm3": ">50%",
      "pointer_convergence": "visible"
    }
  },

  "key_changes": [
    "Reduced batch_size: 512 → 29 (6 gradient updates per epoch instead of 1)",
    "Increased dropout: 0.1 → 0.5 (combat 449K param overfitting on 174 samples)",
    "Rebalanced loss weights: α=0.5→1.0, β=0.25→0.7 (prevent pointer task silencing)",
    "Added gradient clipping: max_norm=1.5 (stabilize training)",
    "Added layer-specific weight decay: encoder=1e-3, heads=1e-2 (differential regularization)",
    "Replaced Smooth L1 with Huber loss: delta=0.08 (tighter gradient bounds)",
    "Added pointer metrics visibility: hit@±3, hit@±5, center MAE, length MAE"
  ],

  "usage": {
    "command": "python -m moola.cli train --model enhanced_simple_lstm --predict-pointers --device cuda --split data/artifacts/splits/v1/fold_0.json",
    "notes": [
      "Requires GPU for reasonable training time (~45min on RTX 4090)",
      "Monitor pointer metrics during training to detect task silencing",
      "If hit@±3 < 10% after 50 epochs, enable uncertainty_weighting=true"
    ]
  }
}
